########################
# application.properties – Configuración global para producción
########################

uvicorn.enabled: true

# Nombre de la aplicación, usado en logs y discovery
spring.application.name=mlsuite

# Perfil activo (entorno de ejecución)
spring.profiles.active=prod

########################
# SQL
########################

# Deshabilita ejecución de scripts SQL explícitos en prod
spring.sql.init.mode=never

# Ruta en classpath a tu script de definición de tablas
#spring.sql.init.schema-locations=classpath:/sql/schema.sql

# Datos
#spring.sql.init.data-locations=classpath:/sql/data.sql

########################
# Logging / SQL
########################

# Nivel de logging para sentencias SQL de Hibernate
logging.level.org.hibernate.SQL=INFO
logging.level.org.springframework.security: INFO

# Ruta y nombre de fichero de logs
logging.file.name=${LOG_PATH:/var/log}/mlsuite.log

# Formato de salida por consola
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# Formato de salida en fichero
logging.pattern.file=%d{ISO8601} [%thread] %-5level %logger{36} - %msg%n

########################
# Data Source / HikariCP
########################

# Driver JDBC para PostgreSQL
spring.datasource.driver-class-name=org.postgresql.Driver

# URL de conexión, con variables de entorno para host, puerto y base de datos
spring.datasource.url=jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_PROD}

# Credenciales de base de datos
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASS}

# Pool de conexiones HikariCP – tamaño máximo de conexiones activas
spring.datasource.hikari.maximum-pool-size=10

# Pool de conexiones HikariCP – número mínimo de conexiones inactivas
spring.datasource.hikari.minimum-idle=2

# Pool de conexiones HikariCP – tiempo máximo de inactividad antes de cerrar conexión (ms)
spring.datasource.hikari.idle-timeout=300000

# Pool de conexiones HikariCP – tiempo de espera para obtener conexión (ms)
spring.datasource.hikari.connection-timeout=30000

# Pool de conexiones HikariCP – vida máxima de una conexión antes de renovarla (ms)
spring.datasource.hikari.max-lifetime=1800000

# Pool de conexiones HikariCP – tiempo de validación de conexiones (ms)
spring.datasource.hikari.validation-timeout=5000

# Pool de conexiones HikariCP – detección de fugas de conexión (ms)
spring.datasource.hikari.leak-detection-threshold=120000

# SQL de inicialización de conexión, útil para validar antes de usar
spring.datasource.hikari.connection-init-sql=SELECT 1


########################
# JPA / Hibernate
########################

# Política de validación de esquema (validate|update|create|create-drop)
spring.jpa.hibernate.ddl-auto=update

# Mostrar o no SQL en logs
spring.jpa.show-sql=false

# Deshabilitar formato de SQL en logs
spring.jpa.properties.hibernate.format_sql=false

# Deshabilitar comentarios SQL en logs
spring.jpa.properties.hibernate.use_sql_comments=false

# Zona horaria JDBC para evitar discrepancias de fecha/hora
spring.jpa.properties.hibernate.jdbc.time_zone=UTC

########################
# Transacciones
########################

# Tiempo de espera por defecto para transacciones
spring.transaction.default-timeout=30s

# Habilitar rollback si la confirmación falla
spring.transaction.rollback-on-commit-failure=true

########################
# OAuth2 Configuration
########################

# Google OAuth2 (Leave empty if not using)
spring.security.oauth2.client.registration.google.client-id=${GOOGLE_CLIENT_ID}
spring.security.oauth2.client.registration.google.client-secret=${GOOGLE_CLIENT_SECRET}

# GitHub OAuth2 (Leave empty if not using)
spring.security.oauth2.client.registration.github.client-id=${GITHUB_CLIENT_ID}
spring.security.oauth2.client.registration.github.client-secret=${GITHUB_CLIENT_SECRET}


###################
# Seguridad y SSL
###################

# Configuración de seguridad para OAuth2
server.port=8443

# Habilitar HTTPS
server.ssl.enabled=true

# Configuración del almacén de claves (keystore) para SSL
server.ssl.key-store=classpath:keystore-local.p12

# Configuración de la contraseña del almacén de claves (keystore)
server.ssl.key-store-password=changeit

# Configuración del tipo de almacén de claves (keystore)
server.ssl.key-store-type=PKCS12

# Configuración de alias del certificado SSL
server.ssl.key-alias=mlsuite-local

# Configuración de cookies de sesión
server.servlet.session.cookie.secure=true

# Configuración de SameSite para cookies de sesión
server.servlet.session.cookie.same-site=NONE

# tamaño máximo de un solo fichero
spring.servlet.multipart.max-file-size: 1000MB

# tamaño máximo de la solicitud completa (incluyendo todos los ficheros)
spring.servlet.multipart.max-request-size: 1000MB